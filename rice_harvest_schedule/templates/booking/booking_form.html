{% extends "base.html" %}
{% load static %}
{% block title %}
‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏£‡∏ñ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≤‡∏ß - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏≤‡∏ß‡∏ô‡∏≤
{% endblock %}
{% block main %}
<div class="container mx-auto p-4" style="margin-top: 4rem;">
    <div class="max-w-7xl mx-auto bg-white border border-gray-300 rounded-lg shadow-lg">
        <h1 class="text-4xl text-center mb-6 mt-6 text-green-700 font-bold">‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏£‡∏ñ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≤‡∏ß</h1>
        <div class="w-full md:flex">
            <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏ñ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß -->
            <div class="md:w-1/2 p-6">
                <img class="mx-auto md:justify-center object-cover md:w-3/4 h-auto rounded-xl shadow-lg" src="{{ vehicle.image.url }}" alt="‡∏£‡∏ñ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≤‡∏ß">
                <div class="mx-auto md:justify-center md:w-3/4 mt-6 p-6 bg-green-50 rounded-xl">
                    <h2 class="text-2xl font-semibold mb-4 text-center text-green-800">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏ñ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß</h2>
                    <div class="space-y-4 text-lg text-gray-800">
                        <div class="flex justify-between items-center">
                            <span class="font-medium">üë®‚Äçüåæ ‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö:</span>
                            <span>{{ vehicle.driver.first_name }} {{ vehicle.driver.last_name }}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-medium">üöú ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏ñ:</span>
                            <span>{{ vehicle.type }}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-medium">üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡πÑ‡∏£‡πà:</span>
                            <span class="text-green-600 font-semibold">{{ vehicle.price }} ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-medium">üìç ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î:</span>
                            <span>{{ vehicle.province }}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-medium">‚úÖ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á:</span>
                            <span class="text-blue-600 font-semibold">{{ vehicle.min_acres }} ‡πÑ‡∏£‡πà</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-medium">üìÖ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏£‡πà‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô:</span>
                            <span class="text-blue-600 font-semibold">{{ vehicle.max_acres_per_day }} ‡πÑ‡∏£‡πà</span>
                        </div>
                        <p class="text-gray-600 text-sm mt-4">
                            * ‡∏´‡∏≤‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏£‡πà‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
                        </p>
                    </div>
                </div>
            </div>
            <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á -->
            <div class="md:w-1/2 p-6" data-min-acres="{{ vehicle.min_acres }}" data-max-acres-per-day="{{ vehicle.max_acres_per_day }}" data-price="{{ vehicle.price }}">
                <form method="post" action="" onsubmit="return validateForm();">
                    {% csrf_token %}
                    <!-- ‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• -->
                    <div class="mb-4">
                        <label for="fullname" class="block text-lg font-medium text-gray-700">üë§ ‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•:</label>
                        <input type="text" id="fullname" name="fullname" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-xl" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" required>
                    </div>
                    <!-- ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á -->
                    <div class="mb-4">
                        <label for="location" class="block text-lg font-medium text-gray-700">üìç ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á:</label>
                        <select id="province" name="province" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-xl" required>
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</option>
                            {% for province in unique_provinces %}
                                <option value="{{ province }}">{{ province }}</option>
                            {% endfor %}
                        </select>
                        <select id="district" name="district" class="mt-2 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-xl" disabled required>
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</option>
                        </select>
                        <select id="subdistrict" name="subdistrict" class="mt-2 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-xl" disabled required>
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡∏ö‡∏•</option>
                        </select>
                    </div>
                    <!-- ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà -->
                    <div class="mb-4">
                        <label for="address" class="block text-lg font-medium text-gray-700">üè† ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</label>
                        <textarea id="address" name="address" rows="3" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-xl" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà" required></textarea>
                    </div>
                    <!-- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏£‡πà -->
                    <div class="mb-4">
                        <label for="quantity" class="block text-lg font-medium text-gray-700">üåæ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏£‡πà:</label>
                        <input type="number" id="quantity" name="quantity" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-xl" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏£‡πà" required>
                        <p id="quantity-warning" class="text-red-500 hidden mt-2">‚ùóÔ∏è ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏£‡πà‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏£‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î</p>
                    </div>
                    <!-- ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì -->
                    <div class="mb-4">
                        <label for="total_price" class="block text-lg font-medium text-gray-700">üíµ ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢:</label>
                        <input type="text" id="total_price" name="total_price" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-xl bg-gray-100" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏£‡πà" readonly>
                    </div>
                    <!-- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô -->
                    <div class="mb-4">
                        <label for="appointment_start_date" class="block text-lg font-medium text-gray-700">üóìÔ∏è ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô:</label>
                        <input type="text" id="appointment_start_date" name="appointment_start_date" class="flatpickr mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-xl" placeholder="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏à‡∏≠‡∏á" required>
                    </div>
                    <!-- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏á‡∏≤‡∏ô -->
                    <div class="mb-4">
                        <label for="appointment_end_date_display" class="block text-lg font-medium text-gray-700">üóìÔ∏è ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏á‡∏≤‡∏ô:</label>
                        <input type="text" id="appointment_end_date_display" name="appointment_end_date_display" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-xl bg-gray-100" placeholder="‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏á‡∏≤‡∏ô‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥" readonly>
                        <input type="hidden" id="appointment_end_date" name="appointment_end_date">
                    </div>
                    <!-- ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ -->
                    <div class="mb-4">
                        <label for="phone" class="block text-lg font-medium text-gray-700">üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠:</label>
                        <input type="text" id="phone" name="phone" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-xl" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå 10 ‡∏´‡∏•‡∏±‡∏Å" required pattern="\d{10}">
                    </div>
                    <!-- ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° -->
                    <div class="mb-4">
                        <label for="details" class="block text-lg font-medium text-gray-700">üìù ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô):</label>
                        <textarea id="details" name="details" rows="3" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-xl" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏≤ ‡∏à‡∏∏‡∏î‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï ‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏ï‡πà‡∏≤‡∏á ‡πÜ"></textarea>
                    </div>
                    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° -->
                    <div class="flex items-center justify-between">
                        <button type="submit" id="submit-button" class="w-full px-6 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 text-xl font-semibold">üì® ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏à‡∏≠‡∏á</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- ‡∏£‡∏ß‡∏°‡πÑ‡∏ü‡∏•‡πå CSS ‡πÅ‡∏•‡∏∞ JavaScript ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://npmcdn.com/flatpickr/dist/l10n/th.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡∏∞‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô JavaScript
        const driver_id = "{{ vehicle.driver.id }}";  
        const eventDates = JSON.parse('{{ event_dates|escapejs }}');
        const flatpickrInstance = flatpickr(".flatpickr", {
            enableTime: false,
            dateFormat: "Y-m-d",
            altInput: true,
            altFormat: 'd/m/Y',
            locale: "th",
            disable: eventDates,
            onReady: function(selectedDates, dateStr, instance) {
                instance.set('enable', []);
            }
        });

        const quantityInput = document.getElementById('quantity');
        const startDateInput = document.getElementById('appointment_start_date');
        const endDateDisplay = document.getElementById('appointment_end_date_display');
        const endDateInput = document.getElementById('appointment_end_date');
        const submitButton = document.getElementById('submit-button');
        const quantityWarning = document.getElementById('quantity-warning');
        const totalPriceInput = document.getElementById('total_price');
        const maxAcresPerDay = parseInt(document.querySelector('[data-max-acres-per-day]').getAttribute('data-max-acres-per-day'), 10);
        const minAcres = parseInt(document.querySelector('[data-min-acres]').getAttribute('data-min-acres'), 10);
        const pricePerAcre = parseFloat(document.querySelector('[data-price]').getAttribute('data-price'));

        function formatDateToDDMMYYYY(date) {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
        }

        function calculateEndDate() {
            const quantity = parseInt(quantityInput.value, 10);
            const startDate = new Date(startDateInput.value);
            if (!isNaN(quantity) && startDate instanceof Date && !isNaN(startDate.getTime())) {
                const daysRequired = Math.ceil(quantity / maxAcresPerDay);
                const endDate = new Date(startDate);
                endDate.setDate(endDate.getDate() + daysRequired - 1);
                endDateDisplay.value = formatDateToDDMMYYYY(endDate);
                endDateInput.value = endDate.toISOString().slice(0, 10);
            }
        }

        function calculateTotalPrice() {
            const quantity = parseInt(quantityInput.value, 10);
            if (!isNaN(quantity) && quantity >= minAcres) {
                const totalPrice = quantity * pricePerAcre;
                totalPriceInput.value = `${totalPrice.toLocaleString()} ‡∏ö‡∏≤‡∏ó`;
            } else {
                totalPriceInput.value = '';
            }
        }

        function validateQuantity() {
            const quantity = parseInt(quantityInput.value, 10);
            if (quantity < minAcres) {
                quantityWarning.classList.remove('hidden');
                submitButton.disabled = true;
            } else {
                quantityWarning.classList.add('hidden');
                submitButton.disabled = false;
            }
        }

        quantityInput.addEventListener('input', function () {
            calculateEndDate();
            calculateTotalPrice();
            validateQuantity();
        });
        startDateInput.addEventListener('input', calculateEndDate);

        window.validateForm = function() {
            const quantity = parseInt(quantityInput.value, 10);
            if (quantity < minAcres) {
                quantityWarning.classList.remove('hidden');
                return false;
            }
            return true;
        };

        // ‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ ‡πÅ‡∏•‡∏∞‡∏ï‡∏≥‡∏ö‡∏•
        document.getElementById('province').addEventListener('change', function() {
            const province = this.value;
            const districtSelect = document.getElementById('district');
            const subdistrictSelect = document.getElementById('subdistrict');

            districtSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</option>';
            subdistrictSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡∏ö‡∏•</option>';
            subdistrictSelect.disabled = true;

            if (province) {
                fetch(`/bookings/get_districts/?province=${encodeURIComponent(province)}`)
                    .then(response => response.json())
                    .then(districts => {
                        districts.forEach(district => {
                            const option = document.createElement('option');
                            option.value = district;
                            option.textContent = district;
                            districtSelect.appendChild(option);
                        });
                        districtSelect.disabled = false;
                    });
            } else {
                districtSelect.disabled = true;
            }
        });

        document.getElementById('district').addEventListener('change', function() {
            const district = this.value;
            const subdistrictSelect = document.getElementById('subdistrict');

            subdistrictSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡∏ö‡∏•</option>';

            if (district) {
                fetch(`/bookings/get_subdistricts/?district=${encodeURIComponent(district)}`)
                    .then(response => response.json())
                    .then(subdistricts => {
                        const uniqueSubdistricts = new Set();
                        subdistricts.forEach(subdistrict => {
                            const subdistrictsArray = subdistrict.split(',');
                            subdistrictsArray.forEach(sub => {
                                const trimmedSub = sub.trim();
                                if (!uniqueSubdistricts.has(trimmedSub)) {
                                    uniqueSubdistricts.add(trimmedSub);
                                    const option = document.createElement('option');
                                    option.value = trimmedSub;
                                    option.textContent = trimmedSub;
                                    subdistrictSelect.appendChild(option);
                                }
                            });
                        });
                        subdistrictSelect.disabled = false;
                    });
            } else {
                subdistrictSelect.disabled = true;
            }
        });

        document.getElementById('subdistrict').addEventListener('change', function() {
            const province = document.getElementById('province').value;
            const district = document.getElementById('district').value;
            const subdistrict = this.value;

            if (province && district && subdistrict) {
                fetch(`/bookings/get_available_dates/?province=${encodeURIComponent(province)}&district=${encodeURIComponent(district)}&subdistrict=${encodeURIComponent(subdistrict)}&driver_id=${driver_id}`)
                    .then(response => response.json())
                    .then(availableDates => {
                        flatpickrInstance.set('enable', availableDates);
                        flatpickrInstance.setDate([]); 
                    });
            }
        });
    });
</script>
{% endblock %}
